<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>SuperSCS: Using SuperSCS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dox_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SuperSCS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Using SuperSCS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="secc"></a>
SuperSCS in C</h1>
<p>You may find a comprehensive example <a class="el" href="page_socp.html">here</a>.</p>
<h1><a class="anchor" id="secmatlab"></a>
SuperSCS in MATLAB</h1>
<p>SuperSCS can be called directly, to solve conic problems, in MATLAB.</p>
<p>Two functions, namely <code>scs_direct</code> and <code>scs_indirect</code>, solve the problem with the direct and indirect methods respectively.</p>
<p>Here is an example:</p>
<div class="fragment"><div class="line">m = 9;</div>
<div class="line">n = 4;</div>
<div class="line">data.A = sparse(randn(m,n));</div>
<div class="line">data.b = randn(m,1);</div>
<div class="line">data.c = randn(n,1);</div>
<div class="line">cones.q = m;</div>
<div class="line">solver_options = <span class="keyword">struct</span>(<span class="stringliteral">&#39;eps&#39;</span>, 1e-5, <span class="stringliteral">&#39;do_super_scs&#39;</span>, 1, <span class="stringliteral">&#39;direction&#39;</span>, 100, ...</div>
<div class="line">   <span class="stringliteral">&#39;memory&#39;</span>, 50, <span class="stringliteral">&#39;rho_x&#39;</span>, .001);</div>
<div class="line">[x,y,s,info] = scs_direct(data, cones, solver_options);</div>
</div><!-- fragment --><p>The user needs to provide three structures:</p>
<ul>
<li><code>data</code>: with the problem data, i.e., the triplet \((A,b,c)\)</li>
<li><code>cones</code>: the specifications of the cone \(\mathcal{K}\)</li>
<li><code>solver_options</code>: (optional) options for the solver</li>
</ul>
<p>To use SuperSCS provide the option <code>solver_options.do_super_scs=1</code>.</p>
<p>A list of all solver options and their default parameters can be found <a class="el" href="util_8h.html#a9c38845e0bf8bb27d4c250bdddcb564b">here</a>.</p>
<p>Note that the method with which SuperSCS computes the direction (e.g., the <a class="el" href="page_directions.html#sec-restarted-broyden">restarted Broyden method</a>, <a class="el" href="page_directions.html#sec-andersons-acceleration">Anderson's acceleration</a> etc) is specified using <code>solver_options.direction</code>. Admissible values are numeric (not strings) and are as follows:</p>
<ul>
<li><code>direction=100</code>: Restarted Broyden method</li>
<li><code>direction=150</code>: Anderson's acceleration</li>
<li><code>direction=200</code>: Fixed point residual</li>
<li><code>direction=300</code>: Full Broyden method</li>
</ul>
<p>Functions <code>scs_direct</code> and <code>scs_indirect</code> return the primal and dual solution of the problem, \((x,s,y)\) and a structure with information about the solution such as the solver time, number of iterations, relative duality gap and more).</p>
<p>By default, SuperSCS does not record the progress of the algorithm. To do so, you need to set the option <code>do_record_progress=1</code> in the solver options.</p>
<h1><a class="anchor" id="seccvxmatlab"></a>
SuperSCS via CVX in MATLAB</h1>
<p>SuperSCS can be used with CVX in MATLAB by simply using </p>
<div class="fragment"><div class="line">cvx_solver <a class="code" href="scs_8h.html#ab0a17856b4bd62f5f7ba4df6e2721e82">scs</a></div>
</div><!-- fragment --><p> and setting the solver option <code>do_super_scs=1</code> as shown below</p>
<div class="fragment"><div class="line">cvx_begin</div>
<div class="line"> cvx_solver <a class="code" href="scs_8h.html#ab0a17856b4bd62f5f7ba4df6e2721e82">scs</a></div>
<div class="line"> cvx_solver_settings(<span class="stringliteral">&#39;eps&#39;</span>, 1e-4,...</div>
<div class="line">     <span class="stringliteral">&#39;do_super_scs&#39;</span>, 1,...</div>
<div class="line">     <span class="stringliteral">&#39;direction&#39;</span>, 150,...</div>
<div class="line">     <span class="stringliteral">&#39;memory&#39;</span>, 10)</div>
<div class="line"> variable x(n)</div>
<div class="line">     minimize( 0.5*x&#39;*Q*x + q&#39;*x + r )</div>
<div class="line">     subject to:</div>
<div class="line">         lb &lt;= x &lt;= ub</div>
<div class="line">         F*x == f</div>
<div class="line">cvx_end</div>
</div><!-- fragment --><p>Several examples are given <a class="el" href="page_cvx_examples.html">here</a>.</p>
<p>Solver info can be stored using the property <code>dumpfile</code> as explained <a class="el" href="page_logging.html#logging_via_cvx">here</a>.</p>
<h1><a class="anchor" id="secpython"></a>
SuperSCS in Python</h1>
<p>In order to use SuperSCS in Python, you first need to <a class="el" href="page_installation.html#sec_installation_python">install the <code>superscs</code> module</a>.</p>
<p>Then, it is straightforward to <code>import superscs</code>, define the problem data (matrix <code>A</code> as a <code>scipy.sparse</code> matrix and vectors <code>b</code> and <code>c</code>), the cone and call <code>superscs.solve</code>:</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> superscs</div>
<div class="line"><span class="keyword">import</span> numpy as np</div>
<div class="line">from scipy <span class="keyword">import</span> sparse</div>
<div class="line">ij = np.array([[0,1,2,3],[0,1,2,3]])</div>
<div class="line">A = sparse.csc_matrix(([-1.,-1.,1.,1.], ij), (4,4))</div>
<div class="line">b = np.array([0.,0.,1,1])</div>
<div class="line">c = np.array([1.,1.,-1,-1])</div>
<div class="line">cone = {<span class="charliteral">&#39;l&#39;</span>: 4}</div>
<div class="line">data = {<span class="charliteral">&#39;A&#39;</span>: A, <span class="charliteral">&#39;b&#39;</span>:b, <span class="charliteral">&#39;c&#39;</span>:c}</div>
<div class="line">sol = superscs.solve(data, cone, use_indirect = False, memory = 50, verbose = 2)</div>
</div><!-- fragment --><p>The last invocation takes as input arguments:</p>
<ol type="1">
<li>the object <code>data</code> which is the triplet \((A,b,c)\); the problem data,</li>
<li>the cone <code>cone</code> which, here, is a linear cone of dimension 4,</li>
<li>additional optional arguments (such as the LBFGS memory)</li>
</ol>
<p>The call returns <code>sol</code>; an object which return the solver status, the solution and additional information.</p>
<p>Here is what we see if we print out <code>sol</code> from the example above:</p>
<div class="fragment"><div class="line">{<span class="stringliteral">&#39;info&#39;</span>: {<span class="stringliteral">&#39;dobj&#39;</span>: -1.9999059647316126,</div>
<div class="line">          <span class="stringliteral">&#39;iter&#39;</span>: 3,</div>
<div class="line">          <span class="stringliteral">&#39;pobj&#39;</span>: -1.999698352184447,</div>
<div class="line">          <span class="stringliteral">&#39;relGap&#39;</span>: 4.1525795644121774e-05,</div>
<div class="line">          <span class="stringliteral">&#39;resDual&#39;</span>: 3.168953637264187e-05,</div>
<div class="line">          <span class="stringliteral">&#39;resInfeas&#39;</span>: nan,</div>
<div class="line">          <span class="stringliteral">&#39;resPri&#39;</span>: 6.556650505320437e-05,</div>
<div class="line">          <span class="stringliteral">&#39;resUnbdd&#39;</span>: 1.376693966512017,</div>
<div class="line">          <span class="stringliteral">&#39;setupTime&#39;</span>: 0.104,</div>
<div class="line">          <span class="stringliteral">&#39;solveTime&#39;</span>: 0.477834,</div>
<div class="line">          <span class="stringliteral">&#39;status&#39;</span>: <span class="stringliteral">&#39;Solved&#39;</span>,</div>
<div class="line">          <span class="stringliteral">&#39;statusVal&#39;</span>: 1},</div>
<div class="line"><span class="charliteral">&#39;s&#39;</span>: array([ 0.,  0.,  0.,  0.]),</div>
<div class="line"><span class="charliteral">&#39;x&#39;</span>: array([  5.13892443e-05,   5.13892443e-05,   9.99900565e-01,</div>
<div class="line">        9.99900565e-01]),</div>
<div class="line"><span class="charliteral">&#39;y&#39;</span>: array([ 0.99995195,  0.99995195,  0.99995298,  0.99995298])}</div>
</div><!-- fragment --><p>We see that <code>sol.status</code> is <code>Solved</code> and the status code is <code>sol.statusVal: 1</code>, meaning that the problem has been solved.</p>
<p>The triplet <code>(x,y,s)</code> is the solution of the problem and <code>sol.pobj</code> and <code>sol.dobj</code> are the values of the primal and dual objectives.</p>
<p>We may also inspect the relative duality gap, primal and dual residuals, the residuals associated with the infeasibility and unboundedness of the solution and the number of iterations required to solve the problem.</p>
<h1><a class="anchor" id="seccvxpython"></a>
SuperSCS via CVX in Python</h1>
<p>First, let us load some necessary libraries </p>
<div class="fragment"><div class="line"><span class="preprocessor"># Loading some libraries...</span></div>
<div class="line"><span class="preprocessor"></span><span class="keyword">import</span> cvxpy as cp</div>
<div class="line"><span class="keyword">import</span> numpy as np</div>
<div class="line"><span class="keyword">import</span> superscs</div>
</div><!-- fragment --><p>In order to verify that SuperSCS is properly installed and CVXPy can use it, run</p>
<div class="fragment"><div class="line">cp.installed_solvers()</div>
</div><!-- fragment --><p>This will return a list of solvers and <code>SUPERSCS</code> should be among them.</p>
<p>Then, we define the problem data </p>
<div class="fragment"><div class="line"><span class="preprocessor"># Problem data...</span></div>
<div class="line"><span class="preprocessor"></span>m = 2</div>
<div class="line">n = 3</div>
<div class="line">T = 10</div>
<div class="line">alpha = 0.1</div>
<div class="line">beta = 1.0</div>
<div class="line">A = np.eye(n) + alpha*np.random.randn(n,n)</div>
<div class="line">B = np.random.randn(n,m)</div>
<div class="line">x_0 = beta*np.random.randn(n,1)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Form and solve control problem...</span></div>
<div class="line"><span class="preprocessor"></span>x = cp.Variable(n, T+1)</div>
<div class="line">u = cp.Variable(m, T)</div>
<div class="line">states = []</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> t in range(T):</div>
<div class="line">     cost = cp.pnorm(u[:,t], 1)</div>
<div class="line">     constr = [x[:,t+1] == A*x[:,t] + B*u[:,t],</div>
<div class="line">               cp.norm(u[:,t], <span class="stringliteral">&#39;inf&#39;</span>) &lt;= 1]</div>
<div class="line">     states.append(cp.Problem(cp.Minimize(cost), constr))</div>
</div><!-- fragment --><p>Finally, we define the optimization problem (we specify the cost function and the constraints) and we invoke the solver </p>
<div class="fragment"><div class="line"><span class="preprocessor"># sums problem objectives and concatenates constraints...</span></div>
<div class="line"><span class="preprocessor"></span>prob = sum(states)</div>
<div class="line">prob.constraints += [x[:,T] == 0, x[:,0] == x_0]</div>
<div class="line">prob.solve(solver=&quot;SUPERSCS&quot;, verbose=True)</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 2 2018 11:02:01 for SuperSCS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
